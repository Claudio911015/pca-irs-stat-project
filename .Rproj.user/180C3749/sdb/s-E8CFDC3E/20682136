{
    "contents" : "library(quantmod)\nlibrary(downloader)\n\nterms = c(1, 2, 3, 4, 5, 7, 10, 30)\nfor (term in terms) {\n  getSymbols(paste('DSWP', term, sep=''), src='FRED')\n}\n\nDSWP1 = last(DSWP1[!is.na(DSWP1)], 250)\nDSWP2 = last(DSWP2[!is.na(DSWP2)], 250)\nDSWP3 = last(DSWP3[!is.na(DSWP3)], 250)\nDSWP4 = last(DSWP4[!is.na(DSWP4)], 250)\nDSWP5 = last(DSWP5[!is.na(DSWP5)], 250)\nDSWP7 = last(DSWP7[!is.na(DSWP7)], 250)\nDSWP10 = last(DSWP10[!is.na(DSWP10)], 250)\nDSWP30 = last(DSWP30[!is.na(DSWP30)], 250)\n\npcDSWP1 = dailyReturn(DSWP1)\npcDSWP2 = dailyReturn(DSWP2)\npcDSWP3 = dailyReturn(DSWP3)\npcDSWP4 = dailyReturn(DSWP4)\npcDSWP5 = dailyReturn(DSWP5)\npcDSWP7 = dailyReturn(DSWP7)\npcDSWP10 = dailyReturn(DSWP10)\npcDSWP30 = dailyReturn(DSWP30)\n\n# pcDSWP1 = diff(DSWP1, lag=1)\n# pcDSWP2 = diff(DSWP2, lag=1)\n# pcDSWP3 = diff(DSWP3, lag=1)\n# pcDSWP4 = diff(DSWP4, lag=1)\n# pcDSWP5 = diff(DSWP5, lag=1)\n# pcDSWP7 = diff(DSWP7, lag=1)\n# pcDSWP10 = diff(DSWP10, lag=1)\n# pcDSWP30 = diff(DSWP30, lag=1)\n# \n# pcDSWP1 = pcDSWP1[!is.na(pcDSWP1)]\n# pcDSWP2 = pcDSWP2[!is.na(pcDSWP2)]\n# pcDSWP3 = pcDSWP3[!is.na(pcDSWP3)]\n# pcDSWP4 = pcDSWP4[!is.na(pcDSWP4)]\n# pcDSWP5 = pcDSWP5[!is.na(pcDSWP5)]\n# pcDSWP7 = pcDSWP7[!is.na(pcDSWP7)]\n# pcDSWP10 = pcDSWP10[!is.na(pcDSWP10)]\n# pcDSWP30 = pcDSWP30[!is.na(pcDSWP30)]\n\nrates = cbind(DSWP1, DSWP2, DSWP3, DSWP4, DSWP5, DSWP7, DSWP10, DSWP30)\n\npc_rates = cbind(pcDSWP1, pcDSWP2, pcDSWP3, pcDSWP4, pcDSWP5, pcDSWP7, pcDSWP10, pcDSWP30)\ncolnames(pc_rates) = c('y1', 'y2', 'y3', 'y4', 'y5', 'y7', 'y10', 'y30')\n\n# autocorrelation\nacfDSWP1 = acf(DSWP1, plot=FALSE)\nacfDSWP1_dataframe = with(acfDSWP1, data.frame(lag, acf))\nq_DSWP1 = ggplot(data = acfDSWP1_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"1 Year Swap Rate\")\nq_DSWP1\n\nacfDSWP2 = acf(DSWP2, plot=FALSE)\nacfDSWP2_dataframe = with(acfDSWP2, data.frame(lag, acf))\nq_DSWP2 = ggplot(data = acfDSWP2_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"2 Year Swap Rate\")\nq_DSWP2\n\nacfDSWP3 = acf(DSWP3, plot=FALSE)\nacfDSWP3_dataframe = with(acfDSWP3, data.frame(lag, acf))\nq_DSWP3 = ggplot(data = acfDSWP3_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"3 Year Swap Rate\")\nq_DSWP3\n\nacfDSWP4 = acf(DSWP4, plot=FALSE)\nacfDSWP4_dataframe = with(acfDSWP4, data.frame(lag, acf))\nq_DSWP4 = ggplot(data = acfDSWP4_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"4 Year Swap Rate\")\nq_DSWP4\n\nacfDSWP5 = acf(DSWP5, plot=FALSE)\nacfDSWP5_dataframe = with(acfDSWP5, data.frame(lag, acf))\nq_DSWP5 = ggplot(data = acfDSWP5_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"5 Year Swap Rate\")\nq_DSWP5\n\nacfDSWP7 = acf(DSWP7, plot=FALSE)\nacfDSWP7_dataframe = with(acfDSWP7, data.frame(lag, acf))\nq_DSWP7 = ggplot(data = acfDSWP7_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"7 Year Swap Rate\")\nq_DSWP7\n\nacfDSWP10 = acf(DSWP10, plot=FALSE)\nacfDSWP10_dataframe = with(acfDSWP10, data.frame(lag, acf))\nq_DSWP10 = ggplot(data = acfDSWP10_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"10 Year Swap Rate\")\nq_DSWP10\n\nacfDSWP30 = acf(DSWP30, plot=FALSE)\nacfDSWP30_dataframe = with(acfDSWP30, data.frame(lag, acf))\nq_DSWP30 = ggplot(data = acfDSWP30_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"30 Year Swap Rate\")\nq_DSWP30\n\nsource(\"multiplot.R\")\npdf(\"acf-yields.pdf\",width=10,height=5)\nmultiplot(q_DSWP1, q_DSWP2, q_DSWP3, q_DSWP4, q_DSWP5, q_DSWP7, q_DSWP10, q_DSWP30, cols=4)\ndev.off()\n\nacfpcDSWP1 = acf(pcDSWP1, plot=FALSE)\nacfpcDSWP1_dataframe = with(acfpcDSWP1, data.frame(lag, acf))\nq_pcDSWP1 = ggplot(data = acfpcDSWP1_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"1 Year (% Change)\")\nq_pcDSWP1\n\nacfpcDSWP2 = acf(pcDSWP2, plot=FALSE)\nacfpcDSWP2_dataframe = with(acfpcDSWP2, data.frame(lag, acf))\nq_pcDSWP2 = ggplot(data = acfpcDSWP2_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"2 Year (% Change)\")\nq_pcDSWP2\n\nacfpcDSWP3 = acf(pcDSWP3, plot=FALSE)\nacfpcDSWP3_dataframe = with(acfpcDSWP3, data.frame(lag, acf))\nq_pcDSWP3 = ggplot(data = acfpcDSWP3_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"3 Year (% Change)\")\nq_pcDSWP3\n\nacfpcDSWP4 = acf(pcDSWP4, plot=FALSE)\nacfpcDSWP4_dataframe = with(acfpcDSWP4, data.frame(lag, acf))\nq_pcDSWP4 = ggplot(data = acfpcDSWP4_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"4 Year (% Change)\")\nq_pcDSWP4\n\nacfpcDSWP5 = acf(pcDSWP5, plot=FALSE)\nacfpcDSWP5_dataframe = with(acfpcDSWP5, data.frame(lag, acf))\nq_pcDSWP5 = ggplot(data = acfpcDSWP5_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"5 Year (% Change)\")\nq_pcDSWP5\n\nacfpcDSWP7 = acf(pcDSWP7, plot=FALSE)\nacfpcDSWP7_dataframe = with(acfpcDSWP7, data.frame(lag, acf))\nq_pcDSWP7 = ggplot(data = acfpcDSWP7_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"7 Year (% Change)\")\nq_pcDSWP7\n\nacfpcDSWP10 = acf(pcDSWP10, plot=FALSE)\nacfpcDSWP10_dataframe = with(acfpcDSWP10, data.frame(lag, acf))\nq_pcDSWP10 = ggplot(data = acfpcDSWP10_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"10 Year (% Change)\")\nq_pcDSWP10\n\nacfpcDSWP30 = acf(pcDSWP30, plot=FALSE)\nacfpcDSWP30_dataframe = with(acfpcDSWP30, data.frame(lag, acf))\nq_pcDSWP30 = ggplot(data = acfpcDSWP30_dataframe, mapping = aes(x = lag, y = acf)) + geom_hline(aes(yintercept = 0)) + geom_segment(mapping = aes(xend = lag, yend = 0)) + xlab(\"Lag\") + ylab(\"Correlation\") + ggtitle(\"30 Year (% Change)\")\nq_pcDSWP30\n\npdf(\"acf-yields-returns.pdf\",width=10,height=5)\nmultiplot(q_pcDSWP1, q_pcDSWP2, q_pcDSWP3, q_pcDSWP4, q_pcDSWP5, q_pcDSWP7, q_pcDSWP10, q_pcDSWP30, cols=4)\ndev.off()\n\nlibrary(ggplot2)\nlibrary(reshape)\ndataframe = data.frame(index(rates), rates)\ncolnames(dataframe) = c('date', 'y1', 'y2', 'y3', 'y4', 'y5', 'y7', 'y10', 'y30')\nmelted = melt(dataframe, id.vars='date')\nplot = ggplot(data=melted, aes(x=date, y=value, color=variable)) + geom_line() + xlab(\"Date\") + ylab(\"IRS Rates\")\npdf(\"descriptive-rates.pdf\",width=10,height=5)\nplot\ndev.off()\n\ndataframe = data.frame(index(pc_rates), pc_rates)\ncolnames(dataframe) = c('date', 'y1', 'y2', 'y3', 'y4', 'y5', 'y7', 'y10', 'y30')\nmelted = melt(dataframe, id.vars='date')\nplot = ggplot(data=melted, aes(x=date, y=value, color=variable)) + geom_line() + xlab(\"Date\") + ylab(\"IRS Rates\")\npdf(\"descriptive-rates-returns.pdf\",width=10,height=5)\nplot\ndev.off()\n\npcadata = pc_rates\nfit = princomp(pcadata, cor=FALSE, scores=TRUE)\n\ncovariance_matrix = cor(pcadata)\nrequire(corrplot)\npdf(\"corrplot-vanilla-returns.pdf\", width=3.3, height=3)\ncorrplot(covariance_matrix, method='shade', type='full', shade.col=NA, tl.col='black')\ndev.off()\n\nlibrary(ggbiplot)\npdf(\"biplot-vanilla-returns.pdf\", width=3.3, height=3)\nggbiplot(fit, obs.scale=1, var.scale=1)\ndev.off()\npdf(\"screeplot-vanilla-returns.pdf\", width=3.3, height=3)\nggscreeplot(fit)\ndev.off()\n\nscores = fit$scores\nscores_dataframe = data.frame(index(pc_rates), scores)\ncolnames(scores_dataframe) = c('date', 'pc1', 'pc2', 'pc3', 'pc4', 'pc5', 'pc6', 'pc7', 'pc8')\nkeeps = c('date', 'pc1', 'pc2', 'pc3')\nscores_dataframe = scores_dataframe[keeps]\nscores_melted = melt(scores_dataframe, id.vars='date')\nplot = ggplot(data=scores_melted, aes(x=as.Date(date), y=value, color=variable)) + geom_line() + xlab('Date') + ylab('Principal Component Score')\npdf(\"pca-scores-vanilla.pdf\", width=10, height=5)\nplot\ndev.off()\n\nloadings = with(fit, unclass(loadings))\nloadings\n\nloadings_dataframe = data.frame(index(loadings), loadings)\ncolnames(loadings_dataframe) = c('tenor', 'pc1', 'pc2', 'pc3', 'pc4', 'pc5', 'pc6', 'pc7', 'pc8')\nkeeps = c('tenor', 'pc1', 'pc2', 'pc3')\nloadings_dataframe = loadings_dataframe[keeps]\nloadings_melted = melt(loadings_dataframe, id.vars='tenor')\nplot = ggplot() + geom_line(data=loadings_melted, aes(x=tenor, y=value, color=variable)) + scale_x_discrete(labels=c('2y1y', '3y1y', '4y1y', '5y1y', '7y1y', '10y2y', '10y5y', '30y10y')) + xlab('Tenor') + ylab('Loading of First 3 PCs')\npdf(\"pca-loadings-vanilla.pdf\", width=10, height=5)\nplot\ndev.off()\n",
    "created" : 1450055563256.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1308476020",
    "id" : "20682136",
    "lastKnownWriteTime" : 1450055328,
    "path" : "~/Dropbox/Dropbox/Linan/Columbia/Academics/2015 Fall/STAT W4290/project/vanilla_returns.R",
    "project_path" : "vanilla_returns.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}